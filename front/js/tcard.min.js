/* 
 
 Author: Cloanta Alexandru
 Name: Tcard Wordpress
 Version: 1.8.0
 
 */
!function(t){function n(n,a){n=t(n);var i={tcardFlip:!1,tcardOn:"button",animationFront:"ready",animationOneTime:!1,randomColor:!1,durationCount:900,autocomplete:"off",frontButton:t(".tcard-button.front"),backButton:t(".tcard-button.back"),tcardFront:t(".tcard-front"),tcardBack:t(".tcard-back"),tcardInner:t(".tcard-inner"),tcg:t(".tcg"),tcgItem:t(".tcg-item"),callBack:function(){},onBack:function(){},onFront:function(){}};this.option=t.extend(!0,i,a),this.init(n,a),"function"==typeof this.option.callBack&&this.option.callBack.call(this,this,a)}function a(n,a,e){function o(n){n.find(t("*[data-animationIn]")).each(function(){t(this).hasClass(n.attr("data-animationIn"))||i(t(this))})}"button"===n?"hover"===a?e.on("mouseenter touchstart",function(){o(t(this))}):"ready"===a&&e.each(function(){i(t(this).find(t("*[data-animationIn]")))}):"hover"===n&&e.each(function(){o(t(this))})}function i(n){n.each(function(){t(this).removeClass("animated "+t(this).attr("data-animationOut")).addClass("animated "+t(this).attr("data-animationIn")).css("animation-delay",t(this).attr("data-delay")+"ms").css("opacity","1")})}function e(n){n.each(function(){t(this).removeClass("animated "+t(this).attr("data-animationIn")).addClass("animated "+t(this).attr("data-animationOut")).css("animation-delay",t(this).attr("data-delay")+"ms")})}function o(){var t,n=document.createElement("fl"),a={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in a)if(void 0!==n.style[t])return a[t]}n.prototype={init:function(n,i){var e=this;n.each(function(){var n=t(this).find(e.option.tcardFront),a=t(this).find(e.option.tcardBack);n.height()>a.height()?(n.css("position","relative"),a.css("position","absolute")):(n.height(),a.height(),a.css("position","relative"),n.css("position","absolute"))}),n.find(t("*[data-animationIn]")).css("opacity","0"),n.filter("*[data-view-in]").length?e.checkTcardView(n,i):a(e.option.tcardOn,e.option.animationFront,n.find(e.option.tcardFront)),"button"==e.option.tcardOn?(0==e.option.tcardFlip&&n.find(e.option.frontButton).on("click touchstart",function(a){n.filter(".flipped,.rotate-in").find(e.option.tcardBack).each(function(){a.preventDefault(),a.stopPropagation(),t(this).hasClass("z-up")&&e.animateElem(t(this),"front",n,i)}),e.animateElem(t(this),"back",n,i)}),n.find(e.option.backButton).on("click touchstart",function(a){e.animateElem(t(this),"front",n,i)})):"hover"==e.option.tcardOn&&(0==e.option.tcardFlip&&n.find(e.option.tcardFront).on("mouseenter touchmove",function(a){n.filter(".flipped,.rotate-in").find(e.option.tcardBack).each(function(){t(this).hasClass("z-up")&&e.animateElem(t(this),"front",n,i)}),t(this).closest(n).find(e.option.tcardBack).hasClass("z-up")||e.animateElem(t(this),"back",n,i)}),n.find(e.option.tcardBack).on("mouseleave touchmove",function(a){t(this).hasClass("z-up")&&e.animateElem(t(this),"front",n,i)})),n.find(e.option.tcardFront).each(function(){e.tcardProgress(t(this),"initProgress",n,i)}),e.tcardGallery(n,i),e.tcardEllipsis(n),e.tcardForm(n,i),e.tcardColor(n,i)},checkTcardView:function(n,i){var e=this;a(e.option.tcardOn,e.option.animationFront,n.find(e.option.tcardFront)),n.filter("*[data-view-in]").each(function(){t(this).css({opacity:"0"}).find(t("*[data-animationIn]")).css({opacity:"0"})}),t(window).on("scroll resize",function(){var i=t(window).height(),r=t(window).scrollTop(),s=r+i;n.filter("*[data-view-in]").each(function(){t(this).closest(".tcard-group").css("overflow","hidden");var i=o(),c=t(this).outerHeight(),d=t(this).parent().offset().top,l=d+c,f=parseInt(t(this).attr("data-offsetview"));l-f>=r&&d+f<=s?t(this).hasClass(t(this).attr("data-view-in"))||t(this).removeClass("animated "+t(this).attr("data-view-out")).addClass("animated "+t(this).attr("data-view-in")).css({opacity:"1"}).one(i,function(t){a(e.option.tcardOn,e.option.animationFront,n.find(e.option.tcardFront))}):t(this).hasClass(t(this).attr("data-view-in"))&&t(this).filter("*[data-view-out]").length&&t(this).removeClass("animated "+t(this).attr("data-view-in")).addClass("animated "+t(this).attr("data-view-out"))})})},animateElem:function(n,a,r,s){function c(t){var n,a;l.hasClass("flip-x")||l.hasClass("flip-y")?(n="flipped",a=" "):(l.hasClass("rotate-x")||l.hasClass("rotate-y"))&&(n="rotate-in",a="rotate-out"),"showback"===t?l.removeClass(a).addClass(n).find(".tcard-back").addClass("z-up"):"showface"===t&&l.removeClass(n).addClass(a).find(".tcard-back").removeClass("z-up")}var d=this,l=n.closest(r),f=o(),h=function(){var t,n=document.createElement("fl"),a={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in a)if(void 0!==n.style[t])return a[t]}(),u=l.find(d.option.tcardFront).find(t("*[data-animationIn]")),p=l.find(d.option.tcardFront).find(t("*[data-animationOut]")),m=l.find(d.option.tcardBack).find(t("*[data-animationIn]")),g=l.find(d.option.tcardBack).find(t("*[data-animationOut]"));"back"===a?function(){function n(){l.hasClass("flip-x")||l.hasClass("flip-y")?l.find(d.option.tcardInner).one(h,function(t){"function"==typeof d.option.onBack&&d.option.onBack.call(),i(m),d.tcardProgress(l.find(d.option.tcardBack),"initProgress",r,s)}):(l.hasClass("rotate-x")||l.hasClass("rotate-y"))&&l.find(d.option.tcardInner).one(f,function(n){0==d.option.animationOneTime&&(u.length>0||p.length>0)?t(this).one(f,function(t){"function"==typeof d.option.onBack&&d.option.onBack.call(),i(m),d.tcardProgress(l.find(d.option.tcardBack),"initProgress",r,s)}):("function"==typeof d.option.onBack&&d.option.onBack.call(),i(m),d.tcardProgress(l.find(d.option.tcardBack),"initProgress",r,s))})}u.length&&p.length?(u.length>0||p.length>0)&&(0==d.option.animationOneTime?(d.tcardProgress(l.find(d.option.tcardFront),"resetProgress",r,s),e(p),p.last().one(f,function(t){c("showback"),n()})):(c("showback"),m.hasClass(m.attr("data-animationIn"))||n())):(c("showback"),0==d.option.animationOneTime?(d.tcardProgress(l.find(d.option.tcardFront),"resetProgress",r,s),n()):m.hasClass(m.attr("data-animationIn"))||n())}():"front"===a&&(l.find(".tcard-button-gallery").hasClass("is-clicked")||function(){function n(){l.hasClass("flip-x")||l.hasClass("flip-y")?l.find(d.option.tcardInner).one(h,function(t){"function"==typeof d.option.onFront&&d.option.onFront.call(),i(u),d.tcardProgress(l.find(d.option.tcardFront),"initProgress",r,s)}):(l.hasClass("rotate-x")||l.hasClass("rotate-y"))&&l.find(d.option.tcardInner).one(f,function(n){m.length>0||g.length>0?t(this).one(f,function(t){"function"==typeof d.option.onFront&&d.option.onFront.call(),i(u),d.tcardProgress(l.find(d.option.tcardFront),"initProgress",r,s)}):("function"==typeof d.option.onFront&&d.option.onFront.call(),i(u),d.tcardProgress(l.find(d.option.tcardFront),"initProgress",r,s))})}m.length&&g.length?(m.length>0||g.length>0)&&(0==d.option.animationOneTime?(d.tcardProgress(l.find(d.option.tcardBack),"resetProgress",r,s),e(g),g.last().one(f,function(t){c("showface"),n()})):c("showface")):(c("showface"),0==d.option.animationOneTime&&(d.tcardProgress(l.find(d.option.tcardBack),"resetProgress",r,s),n()))}())},tcardProgress:function(n,a,i,e){function r(n,a){n.find(".count").each(function(n,i){props={count:a},t(this).animate(props,{duration:s.option.durationCount,step:function(n){t(this).text(Math.ceil(n))}})})}var s=this,c=o(),d=n.find(".tcard-skill-point");"initProgress"===a?d.each(function(){t(this).closest(".tcard-skills").hasClass("bar")?t(this).each(function(n){var a=t(this),e=a.attr("data-number");e<0&&(e=0);var o=[];o[n]=e,a.closest(i).hasClass("skin_1")&&(o[n]=o[n]/10),a.closest(".skill-item").hasClass("animated")?a.closest(".skill-item").one(c,function(t){a.find(".tcard-bar").css({width:o[n]+"%"}),r(a,e)}):(a.find(".tcard-bar").css({width:o[n]+"%"}),r(a,e))}):t(this).closest(".tcard-skills").hasClass("circle")?t(this).each(function(){var n=t(this),a=n.attr("data-number");n.find(t(".circle-progress")).each(function(){var i=t(this),e=i.attr("r"),o=Math.PI*(2*e);a<0&&(a=0),n.closest(".skill-item").hasClass("animated")?n.closest(".skill-item").one(c,function(t){i.css({strokeDashoffset:(100-a)/100*o})}):i.css({strokeDashoffset:(100-a)/100*o})}),n.closest(".skill-item").hasClass("animated")?n.closest(".skill-item").one(c,function(t){r(n,a)}):r(n,a)}):t(this).each(function(){var n=t(this).attr("data-number"),a=t(this).find(".count").text();a&&0!=a||r(t(this),n)})}):"resetProgress"===a&&d.each(function(){t(this).find(".tcard-bar").css({width:0}),t(this).find(t(".circle-progress")).each(function(){var n=t(this).attr("r"),a=Math.round(Math.PI*(2*n)-1);t(this).css({strokeDashoffset:a})}),r(t(this),0)})},tcardGallery:function(n,a){var i=this;t(".tcg-toggle-sidebar").on("click",function(){t(this).toggleClass("is-open");t(this).closest(".tcg-group").find(".tcg-sidebar").toggleClass("is-open")}),n.find(".tcard-button-gallery").on("click",function(a){a.preventDefault(),a.stopPropagation(),t(this).addClass("is-clicked");var e=t(this).attr("data-tcg"),o=(t("*[data-tcg='"+e+"']").closest(n).find("*[data-user-thumbnail]"),t(this).attr("data-open-tcg")),r=t("*[data-tcg-group='"+e+"']");r.fadeIn(0).addClass("is-open");var s=r.find("*[data-tcg-open='"+o+"']");!function(t,n){function a(t,a){if(i=!0,n=a,t.removeClass("current").fadeOut(200),t.eq(a).removeClass("previous").addClass("current").fadeIn(400),r.html(a+1),a>0)for(t.eq(a-1).addClass("previous").fadeOut(200);--a;)t.eq(a-1).addClass("previous").fadeOut(200);setTimeout(function(){i=!1},500)}var i=!1,e=t.find(".tcg-item"),o=e.length,r=t.closest(".tcg-group").find(".tcg-current-counter");t.closest(".tcg-group").find(".tcg-counter-all").html(t.find(".tcg-item").length),t.find(".tcg-item").length?r.html(1):r.html(0),t.find(".tcg-right").off(),t.find(".tcg-right").on("click",function(){i||(t.find(".tcg-item").length!==o&&(e=t.find(".tcg-item"),o=e.length,n=e.filter(".current").index()),n<o&&(++n===o&&(n=0),a(e,n)))}),t.find(".tcg-left").off(),t.find(".tcg-left").on("click",function(){i||(t.find(".tcg-item").length!==o&&(e=t.find(".tcg-item"),o=e.length,n=e.filter(".current").index()),n>-1&&(-1==--n&&(n=o-1),a(e,n)))})}(s,0),s.fadeIn(0).addClass("is-open").find(i.option.tcgItem).first().fadeIn(0).addClass("current"),r.find(".tcg-close").on("click",function(){r.removeClass("is-open").fadeOut().find(".tcg-sidebar").removeClass("is-open").find(".tcg-user").removeClass("user-activ"),r.find(".tcg-toggle-sidebar").removeClass("is-open"),r.find(i.option.tcg).removeClass("is-open").fadeOut().find(i.option.tcgItem).removeClass("current previous").fadeOut(),n.find("*[data-open-tcg]").removeClass("is-clicked")})})},tcardEllipsis:function(n,a){function i(t,n,a){var i=t.height();for(n.html(a);n.outerHeight()>i;)n.html(function(t,n){return n.replace(/\W*\s(\S)*$/,"...")})}n.find("*[data-text='ellipsis']").each(function(){var n=t(this);n.html(n.html()).wrapInner("<div class='ellipsis'></div>");var a=n.find(".ellipsis");n.css("height","330px");var e=a.html();i(n,a,e),t(window).on("resize",function(){i(n,a,e)})})},tcardForm:function(n,a){n.find(".tc-form-button.contact").on("click",function(a){a.preventDefault();var i,e,o=t(this),r=[];(e=o.closest(".tcard-form.contact")).find(".tcard-full_name").length&&(""==e.find(".tcard-full_name").val()?(r.push(["Full Name field is required","tcard-full_name"]),i=!1):e.find(".tcard-full_name").val().length<4&&(r.push(["Full name too short!!","tcard-full_name"]),i=!1)),e.find(".tcard-subject").length&&""==e.find(".tcard-subject").val()&&(r.push(["Subject field is required","tcard-subject"]),i=!1),e.find(".tcard-first_name").length&&""==e.find(".tcard-first_name").val()&&(r.push(["First Name field is required","tcard-first_name"]),i=!1),e.find(".tcard-last_name").length&&""==e.find(".tcard-last_name").val()&&(r.push(["Last Name field is required","tcard-last_name"]),i=!1);var s=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.find(".tcard-email").val());e.find(".tcard-email").length&&(""==e.find(".tcard-email").val()?(r.push(["Email field is required","tcard-email"]),i=!1):s||(r.push(["The e-mail address entered is invalid.","tcard-email"]),i=!1)),e.find(".tcard-message").length&&""==e.find(".tcard-message").val()&&(r.push(["Message field is empty. Please say something","tcard-message"]),i=!1);var c=/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(e.find(".tcard-phone").val());e.find(".tcard-phone").length&&e.find(".tcard-phone").val().length&&!c&&(r.push(["Phone number is invalid.","tcard-phone"]),i=!1);var d=/^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3}))(\:\d+)?(\/[-a-z\d%_.~+]*)*(\?[;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/i.test(e.find(".tcard-website").val());if(e.find(".tcard-website").length&&e.find(".tcard-website").val().length&&!d&&(r.push(["Website URL is not valid.","tcard-website"]),i=!1),0==i)return function(a,i){a.find(".tcard-errors.contact").length||(a.append('<div class="tcard-errors contact"><div class="tc-close-errors">X</div></div>'),n.find(".tc-close-errors").on("click",function(){t(this).parent(".tcard-errors").fadeOut(400,function(){t(this).remove()})}));for(var e=a.find(".tcard-errors.contact"),o=[],r=0;r<i.length;r++)e.find("."+i[r][1]).length?e.find("."+i[r][1]).find(".tcard-error-msg").text(i[r][0]):(e.append(t('<p> <span class="tc-line-error">-</span> <span class="tcard-error-msg"></span> </p>').addClass(i[r][1])),e.find("."+i[r][1]).find(".tcard-error-msg").text(i[r][0])),o.push(i[r][1]);for(r=0;r<e.find("p").length;r++)e.find("p").eq(r).hasClass(o[r])||e.find("p").eq(r).remove()}(e,r),!1;for(var l=[],f=0;f<e.find(".tcard-form-item input").length;f++)l[f]=[e.find(".tcard-form-item input").eq(f).attr("data-field"),e.find(".tcard-form-item input").eq(f).val()];var h,u=t(this).closest(".tcard").index();t(this).closest(".tcard-front").length?h="front":t(this).closest(".tcard-back").length&&(h="back");var p={action:"tcard_contact",security:tcard_front.tcard_contact,fields:l,message:e.find(".tcard-form-item textarea").val(),group_id:e.attr("data-group_id"),skin_key:u,side:h};return t.ajax({url:tcard_front.ajaxurl,type:"POST",data:p,success:function(n){var a='<div style="background: green" class="tcard-success"><p> '+n+" </p></div>";t.when(n).promise().done(function(){e.append(a),e.find(".tcard-success").fadeOut(5e3,function(){t(this).remove()})})},error:function(a){var i='<div class="tcard-errors msg"><div class="tc-close-errors">X</div><p> '+a.responseText+" </p></div>";e.append(i),n.find(".tc-close-errors").on("click",function(){t(this).parent(".tcard-errors").fadeOut(400,function(){t(this).remove()})})}}),e.find(".tcard-form-item input, .tcard-form-item textarea").val(""),e.find(".tcard-form-item").removeClass("active"),e.find(".tcard-errors.contact").remove(),!1}),n.find(".tc-close-errors").on("click",function(){t(this).parent(".tcard-errors").fadeOut(400,function(){t(this).remove()})}),n.find("form").attr("autocomplete",this.option.autocomplete).find("input,textarea").on("keyup",function(){t(this).val()?t(this).parent().addClass("active"):t(this).parent().removeClass("active")})},tcardColor:function(n,a){var i,e,o=["air-force-blue","alizarin","alizarin-crimson","amaranth","amber","american-rose","android-green","awesome","azure","beige","black","blue","darkblue","ball-blue","bleu-de-france","blue-green","blue-purple","bright-green","canary-yellow","carmine","carolina-blue","cerulean","cerulean-blue","chrome-yellow","cinnabar","cool-black","cornflower-blue","dark-slate-gray","dark-gray","davy-grey","debian-red","deep-magenta","deep-pink","egyptian-blue","electric-yellow","electric-violet","jungle-green","lemon","lemon-lime","lava","lavender-blue","light-sea-green","light-slate-gray","majorelle-blue","medium-persian-blue","magenta","navy","orange","persian-red","prussian-blue","paris-green","rose-madder","royal-blue","saint-blue","sea-blue","screamin-green","shamrock-green","true-blue","teal","yellowgreen"];if(1==this.option.randomColor){for(r=0;r<o.length;r++)n.find(".tcard-front,.tcard-back").removeClass(""+o[r]);for(var r=0;r<n.length;r++)e=o.length-.5,i=Math.round(Math.random()*e),t(n[r]).find(".tcard-front,.tcard-back").addClass(o[i])}}},t.fn.tcard=function(a){var i=t.data(this,"tcard");if(void 0===i)return a=a||{},t.data(this,"tcard",new n(this,a)),this;if(t.isFunction(n.prototype[a])){var e=Array.prototype.slice.call(arguments);return e.shift(),n.prototype[a].apply(i,e)}return a&&t.error("Method "+a+" does not exist on tcard"),this}}(jQuery);
/* 
 
 Author: Cloanta Alexandru
 Name: Tcard Wordpress
 Version: 1.8.0
 
 */

!function(t){"use strict";t(document).on("ready",function(){var e=!1;t(document).on("click",".tcard-row-bar",function(e){if(e.target==this){var a=t(this).find("input.tcard_check");t(this).next(".tcard-skin").slideToggle(),a.prop("checked")?a.prop("checked",!1):a.prop("checked",!0)}}),t(".tcard-container-skins").sortable({handle:".tcard-row-bar",opacity:.8,cursor:"move",delay:100,placeholder:"tcard-highlight",start:function(e,a){for(var n=0;n<t(".tcard-row").length;n++)t(".tcard-row").eq(n).attr("data-index",n);t(".tcard-highlight").height(a.item.height())},update:function(e,a){n.reorder(".tcard-row"),t(".tcard-textarea").each(function(){wp.editor.remove(t(this).attr("id")),n.add_wp_editor(t(this))})}});var a=0;t(".tc-add-new-skin").on("click",function(n){return t(".select-tcard-group select").val()?t("#select-skin").val()?void(e||(t(this).find("input").val()>0&&(a=t(this).find("input").val()),a++,t(".tcard-count-skin").find("span").text(a),t(this).find("input").val(a),i.add_skin("new-skin",t("#select-skin").val(),a,""))):(alert("Please select type of skin"),void t(this).find("input").val("")):(alert("Please create a group"),void t(this).find("input").val(""))}),t(document).on("click",".tcard-delete-skin",function(){var e=t(this).closest(".tcard-row").index();t(".tcard-row").each(function(){t(this).attr("data-index",t(this).index())}),t(this).closest(".tcard-row").remove(),t(".tcard-count-skin").find("span").text(t(".tcard-row").length),t(".tc-add-new-skin").find("input").val(t(".tcard-row").length);for(var a=0;a<t(".tcard-row").length;a++)t(".tcard-skin-order").eq(a).text(a+1);i.delete_skin(e,t(".tcard-row").length),n.reorder(".tcard-row")}),t("#select-skin").on("change",function(){if(!t(".select-tcard-group select").val())return alert("Please create a group."),void t(this).val("");i.select_skin(t(this).val())}),t(".delete-tcard-group").on("click",function(){var e;return e=t(".tcard-group-title").val()?t(".tcard-group-title").val():t(".select-tcard-group select option[selected]").text(),confirm("Are you sure you want to remove "+e+" group ?")}),t(document).on("click",".tcard-settings",function(){t(this).next(".tcard-modal").fadeIn().addClass("is-open"),t(".tcard-container-skins").sortable("disable")}),t(document).on("click",".tcard-element-bar",function(){n.modal(t(this).next(".tcard-modal"))}),t(document).on("click",".tcard-modal,.tcard-close-modal",function(e){e.target==this&&(t(this).closest(".tcard-modal").fadeOut().removeClass("is-open"),setTimeout(function(){t(".tcard-container-skins").sortable("enable")},200))}),t("#tcard-save").on("click",function(e){window.onbeforeunload=null,t(".spinner").css("visibility","visible")}),t(".copy-shortcode").on("click",function(){n.copy_shortcode(document.getElementById("tcard-code"))}),t(".tcard-shortcode").on("click",function(){n.copy_shortcode(this)}),t(".elements-menu h4").on("click",function(){if(!t(this).hasClass("tc-current-side")){if(e)return;var a=t(this).attr("data-tcard-menu");t(".elements-menu h4").removeClass("tc-current-side"),t(this).addClass("tc-current-side"),n.fade_content(a,".tcard-item-inner","data-tcard-box",".tcard-sidebar-item.elements",10)}}),t(document).on("click",".tcard-add-item",function(){n.add_item_list(t(this),t(this).text())}),t(".tcard-input").on("input",function(t){window.onbeforeunload=function(){return!0}}),t(document).on("click",".tcard-remove-item",function(){t(this).closest(".tcard-modal-item").remove()}),t(document).on("click",".settings-btn",function(){if(!t(this).hasClass("tc-current-side")){if(e)return;var a=t(this).attr("data-menu-container");t(".tcard-modal.is-open .settings-btn").removeClass("tc-current-side"),t(this).addClass("tc-current-side");var i=t(this).closest(".tcard-modal").find(".tcard-modal-container"),o=t(this).closest(".tcard-modal").find(".tcard-modal-content");n.fade_content(a,i,"data-modal-container",o,20)}});var n={fade_content:function(a,n,i,o,c){e=!0,t(n).each(function(){var e=t(this).attr(i),n=t(this);if(-1!==e.indexOf(a)){t(this).fadeIn(500),t(this).parent(o).animate({height:n.height()+c},200);var s=t(this).find(".button.wp-color-result"),r=n.height()+c;s.length&&(s.on("click",function(){n.parent(o).animate({height:n.height()+c},100)}),n.on("click",function(){s.hasClass("wp-picker-open")&&n.parent(o).animate({height:r},100)}))}else t(this).fadeOut(0)}),setTimeout(function(){e=!1},400)},setWidth:function(e,a){var n=["tc-1","tc-2","tc-3","tc-4"],i=-1;n.forEach(function(t,e){a.closest(".tcard-element").hasClass(n[e])&&(i=e)}),a.closest(".tcard-element").each(function(){"increase"==e?i<n.length-1&&(i++,t(this).removeClass(n[i-1]).addClass(n[i])):"decrease"==e&&i>0&&(i--,t(this).removeClass(n[i+1]).addClass(n[i])),t(this).one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){var e=Math.round((t(this).width()+6)/t(this).parent().width()*100)+"%";t(this).find(".elem-width").val(e)})}),window.onbeforeunload=function(){return!0}},modal:function(e){e.fadeIn().addClass("is-open"),e.find(".tc-input-title").on("input",function(){function e(t){var e=document.createElement("DIV");return e.innerHTML=t,e.textContent||e.innerText}var a;a=t(this).val().length>12?e(t(this).val()).substr(0,12)+"...":e(t(this).val()),t(this).closest(".tcard-element").find(".tcard-element-bar span").text(a)}),e.find(".clear_after_login").on("click",function(){t(this).next("select").each(function(){t(this).find("option").removeAttr("selected")})}),e.find(".select-social").on("change",function(){t(this).closest(".tcard-element").find(".tcard-element-bar span").text(t(this).val())}),e.find(".tc-show-input").length&&e.find("select.tc-show-input").on("change",function(){t(this).closest(".tc_button").length?"text"==t(this).val()||"link"==t(this).val()?t(this).closest(".tc_button").find(".tchp_text_btn").css("display","block"):t(this).closest(".tc_button").find(".tchp_text_btn").css("display","none").val(""):"text"==t(this).val()||"link"==t(this).val()?t(this).next(".tchp_text_btn").css("display","block"):t(this).next(".tchp_text_btn").css("display","none").val("")})},reorder:function(e){var a=[];t(".tcard_skin_id").each(function(){a.push(t(this).val())}),a.sort(function(t,e){return t-e});for(var n=0;n<t(".tcard_skin_id").length;n++)t(".tcard_skin_id").eq(n).val(a[n]);t(e).each(function(){var e=parseInt(t(this).attr("data-index")),a=t(this).index();t(this).find(".tcard-skin-order").text(a+1),t(this).find(".tcard_check").attr("name","tcard_check_order"+a),t(this).find(".tcard-input").each(function(){var n=t(this).attr("name").replace(e,a);t(this).attr("name",n)}),t(this).find(".assigns-tcard-gallery select,.tcg-box input").each(function(){var n=t(this).attr("name").replace(e,a);t(this).attr("name",n)}),window.onbeforeunload=function(){return!0}})},add_wp_editor:function(e){t(e).each(function(){var e=t(this).attr("id");wp.editor.initialize(e,{mediaButtons:!0,tinymce:{wpautop:!0,toolbar1:"formatselect bold italic | bullist numlist | blockquote | alignleft aligncenter alignright | wp_more",min_height:"150",plugins:"colorpicker lists compat3x directionality link image charmap hr image fullscreen media paste tabfocus textcolor wordpress wpautoresize wpdialogs wpeditimage wpemoji wpgallery wplink wpview wptextpattern",wpautop:!1,init_instance_callback:function(e){e.on("keyup",function(a){t("#"+e.id).each(function(){if(t(this).closest(".tcard-modal-item").hasClass("tc-textarea-title")){var e,a=tinyMCE.activeEditor.getContent({format:"text"});e=a.length>12?a.substr(0,12)+"...":a,t(this).closest(".tcard-element").find(".tcard-element-bar span").text(e),window.onbeforeunload=function(){return!0}}})})}},quicktags:{buttons:"strong,em,link,img,block,ul,ol,li,code,ins,more"}})})},add_item_list:function(e,a){var n,i=e.closest(".tcard-row").index();n=e.closest(".tcard-main-elem").hasClass("front-side")?"front":"back";var o,c,s,r,l,d,u=e.closest(".tcard-modal-body").find(".tcard-modal-item"),h=e.closest(".tcard-modal-body").find(".tcard-modal-content"),m='<div class="tcard-modal-item"><div class="tcard-modal-item-inner"><h4 class="tcard-with-em">Item Title: <br><span class="tcard-em">Require</span></h4><input class="tcard-input" type="text" name="footer'+i+"_"+n+"[info_list_title"+(o=e.attr("data-itemnum")?e.attr("data-itemnum"):"")+'][]" value=""><h4 class="tcard-remove-item"></h4></div><div class="tcard-modal-item-inner"><h4>Item Text: </h4><input class="tcard-input" type="text" name="footer'+i+"_"+n+"[info_list_text"+o+'][]" value=""></div><div class="tcard-animation"><h4>Delay:</h4><input class="tcard-input" type="number" name="footer'+i+"_"+n+'[delay][]" value=""></div></div>';h.hasClass("contact")?(c='<h4 class="tcard-with-em">Label name: <br> <em class="tcard-em">Default : '+a+" </em></h4>",r="contact_item",l="content",s="contact",d=a):h.hasClass("register")?(c='<h4 class="tcard-with-em">Label name: <br> <em class="tcard-em">Default : '+a+" </em></h4>",r="register_item",l="content",s="register",d=a):(c='<h4><i class="fab fa-'+("google+"==a?"google-plus-square":"instagram"==a||"linkedin"==a||"flickr"==a?a:a+"-square")+'"></i> </h4>',s="social_list_order"+o,r="social_list"+o,l="footer",d=a+" username");var p='<div class="tcard-modal-item"><div class="tcard-modal-item-inner"><input class="tcard-input" type="hidden" name="'+l+i+"_"+n+"["+s+'][]" value="'+a+'">'+c+'<input class="tcard-input" placeholder="'+d+'" type="text" name="'+l+i+"_"+n+"["+r+'][]" value=""><h4 class="tcard-remove-item"></h4></div><div class="tcard-animation"><h4>Delay:</h4><input class="tcard-input" type="number" name="'+l+i+"_"+n+'[delay][]" value=""></div></div>',f='<div class="tcard-modal-item tc-skill-item"><div class="tc-skill-name"><h4>Skill name: </h4><input class="tcard-input" type="text" name="content'+i+"_"+n+"[skills_skill"+o+'][]" value=""><h4 class="tcard-remove-item"></h4></div><div class="tc-skill-percent"><h4>Skill percent: </h4><input class="tcard-input" type="number" name="content'+i+"_"+n+"[skills_percent"+o+'][]" value=""></div><div class="tcard-animation"><h4>Delay:</h4><input class="tcard-input" type="number" name="content'+i+"_"+n+'[delay][]" value=""></div></div>',g='<div class="tcard-modal-item"><div class="tcard-modal-item-inner"><h4>Text: </h4><input class="tcard-input" type="text" name="content'+i+"_"+n+"[list"+o+'][]" value=""><h4 class="tcard-remove-item"></h4></div><div class="tcard-animation"><h4>Delay:</h4><input class="tcard-input" type="number" name="content'+i+"_"+n+'[delay][]" value=""></div></div>',v='<div class="tcard-modal-item"><div class="tcard-modal-item-inner"><input class="tcard-input" type="hidden" name="header'+i+"_"+n+"[social_button_order"+o+'][]" value="'+a+'">'+c+'<input class="tcard-input" type="text" placeholder="'+a+' username" name="header'+i+"_"+n+"[social_button"+o+'][]" value=""><h4 class="tcard-remove-item"></h4></div></div>',_=e.closest(".tcard-item").attr("data-item"),b='<div class="tcard-modal-item"><div class="tcard-modal-item-inner"><input class="tcard-input" type="hidden" name="'+(_=_.replace("tcard-",""))+i+"_"+n+"[instagram_profile_order"+o+'][]" value="'+a+'"><h4 class="social_profile"><span>'+a+'</span> animation: </h4><div class="tcard-animation"><h4>Animation In:</h4><select class="tcard-input" name="'+_+i+"_"+n+'[animation_in][]">'+function(){var t,e=["shake","headShake","swing","tada","wobble","jello","bounceIn","bounceInDown","bounceInLeft","bounceInRight","bounceInUp","fadeIn","fadeInDown","fadeInDownBig","fadeInLeft","fadeInLeftBig","fadeInRight","fadeInRightBig","fadeInUp","fadeInUpBig","flipInX","flipInY","lightSpeedIn","rotateIn","rotateInDownLeft","rotateInDownRight","rotateInUpLeft","rotateInUpRight","hinge","jackInTheBox","rollIn","zoomIn","zoomInDown","zoomInLeft","zoomInRight","zoomInUp","slideInDown","slideInLeft","slideInRight","slideInUp"];t="<option></option>";for(var a=0;a<e.length;a++)t+="<option value="+e[a]+">"+e[a]+"</option>";return t}()+'</select></div><h4 class="tcard-remove-item"></h4><div class="tcard-animation"><h4>Animation Out:</h4><select class="tcard-input" name="'+_+i+"_"+n+'[animation_out][]">'+function(){var t,e=["shake","headShake","swing","tada","wobble","jello","bounceOut","bounceOutDown","bounceOutLeft","bounceOutRight","bounceOutUp","fadeOut","fadeOutDown","fadeOutDownBig","fadeOutLeft","fadeOutLeftBig","fadeOutRight","fadeOutRightBig","fadeOutUp","fadeOutUpBig","flipOutX","flipOutY","lightSpeedOut","rotateOut","rotateOutDownLeft","rotateOutDownRight","rotateOutUpLeft","rotateOutUpRight","hinge","jackInTheBox","rollOut","zoomOut","zoomOutDown","zoomOutLeft","zoomOutRight","zoomOutUp","slideOutDown","slideOutLeft","slideOutRight","slideOutUp"];t="<option></option>";for(var a=0;a<e.length;a++)t+="<option value="+e[a]+">"+e[a]+"</option>";return t}()+'</select></div><div class="tcard-animation"><h4>Delay:</h4><input class="tcard-input" type="number" name="'+_+i+"_"+n+'[delay][]" value=""></div></div></div>';h.hasClass("info_list")?u.last().before(t(m).appendTo(h)):h.hasClass("social_list")||h.hasClass("contact")||h.hasClass("register")?h.hasClass("social_list")?u.last().before(t(p).appendTo(h)):u.last().prev().before(t(p).appendTo(h)):h.hasClass("skills")?u.last().before(t(f).appendTo(h)):h.hasClass("list")?u.last().before(t(g).appendTo(h)):h.hasClass("social_button")?u.filter(".last").length?u.filter(".last").before(t(v).appendTo(h)):u.last().before(t(v).appendTo(h)):h.hasClass("instagram_profile")&&t(b).appendTo(h),window.onbeforeunload=function(){return!0}},copy_shortcode:function(t){var e,a;window.getSelection?(a=window.getSelection(),(e=document.createRange()).selectNodeContents(t),a.removeAllRanges(),a.addRange(e)):document.body.createTextRange&&((e=document.body.createTextRange()).moveToElementText(t),e.select()),document.execCommand("Copy")},upload_image:function(){var e,a=wp.media({title:"Tcard Profile Images Upload",multiple:!1,library:{type:"image"},button:{text:"Insert into profile"}});t(document).on("click",".tcard-up-image",function(n){return a.open(),e=t(this),!1}),a.on("select",function(){var t=a.state().get("selection").toJSON();return t.length&&(e.prev(".tcard-image-input").val(t[0].url),e.closest(".tcard-modal-content").find(".tcard-profile-image").css("display","block"),e.closest(".tcard-modal-content").find(".tcard-profile-image img").attr("src",t[0].url)),!1}),t(".tcard-image-input").on("change",function(){t(this).closest(".tcard-modal-content").find(".tcard-profile-image").css("display","block"),t(this).closest(".tcard-modal-content").find(".tcard-profile-image img").attr("src",t(this).val())})},gallery:function(){function e(){t(".tcard-gallery .gallery").sortable({opacity:.8,cursor:"move",delay:100,placeholder:"tcg-highlight",start:function(e,a){t(".tcg-highlight").height(a.item.outerHeight())}})}var a,n=wp.media({title:"Tcard Multiple Images Upload",multiple:!0,library:{type:"image"},button:{text:"Insert into gallery"}});t(document).on("click",".tc-multiple-images",function(){return n.open(),a=t(this),!1}),n.on("select",function(){var t=n.state().get("selection").toJSON();if(t.length)for(var e=0;e<t.length;e++){var i='<div class="tcg-box" style="background-image: url('+t[e].url+')"><input type="hidden" name="tcg_gallery'+a.closest(".tcard-row").index()+'[image][]" value='+t[e].url+'><div class="remove-tcg-img"></div></div>';a.closest(".tcard-gallery").find(".gallery").append(i)}return!1});var i;t(document).on("focusin",".assigns-tcard-gallery select",function(){i=this.value}),t(document).on("change",".assigns-tcard-gallery select",function(){if(t(this).val()!==i&&(t(this).closest(".tcard-gallery").find(".gallery").remove(),!t(this).val().length&&t(this).val().length||(t(this).closest(".tcard-gallery").append('<div class="gallery"></div>'),e())),t(this).val())t(this).closest(".tcard-gallery").find(".tc-multiple-images").remove();else{t(this).closest(".tcard-gallery").find(".tcard-gallery-bar").append('<span class="tc-multiple-images"><i class="fas fa-cloud-upload-alt"></i></i></span>')}window.onbeforeunload=function(){return!0}}),t(document).on("click",".remove-tcg-img",function(){t(this).closest(".tcg-box").remove()}),t(document).on("change",".thumbnail-name select",function(){var e='<input class="thumbnail_title" type="text" name="tcg_gallery'+t(this).closest(".tcard-row").index()+'[thumbnail_title]" value="">';"thumbnail_title"==t(this).val()?t(this).parent().append(e):t(this).parent().find(".thumbnail_title").remove(),window.onbeforeunload=function(){return!0}}),e()}};n.add_wp_editor(".tcard-textarea"),n.upload_image(),n.gallery();var i={add_skin:function(o,c,s,r){e=!0;var l={action:"tcard_add_skin",security:tcard.add_skin,group_id:tcard.group_id,type_action:o,nameSkin:c,startCount:s-1,stopCount:s,skinCloned:r};t.ajax({url:ajaxurl,type:"POST",data:l,success:function(a){t(".spinner").css("visibility","visible"),"clone-skin"==o?t(a).appendTo(".tcard-container-skins").find(".skin-cloned-after").html('<i class="fas fa-clone"></i> '+c+"."+(r+1)):t(a).appendTo(".tcard-container-skins"),t.when(a).promise().done(function(){t(".spinner").css("visibility","hidden"),n.mainElements(),n.add_wp_editor(t(a).find(".tcard-textarea")),t(".tcard-container-skins").hasClass("customSkin")&&(n.sortable(),t(".modal-post-content").sortable({opacity:.8,cursor:"move",delay:100})),n.colorPicker(".tcard-color-picker"),e=!1})},error:function(e){alert("Skin could not load"),t(".tcard-row").eq(a).length?a=s-1:a-=1,t(".tcard-count-skin").find("span").text(a),t(".tc-add-new-skin").find("input").val(a),i.delete_skin(a,t(".tcard-row").length)}})},delete_skin:function(e,a){var n={action:"tcard_delete_skin",security:tcard.delete_skin,group_id:tcard.group_id,skin_key:e,skins_number:a};t.ajax({url:ajaxurl,type:"POST",data:n,success:function(t){window.onbeforeunload=function(){return!0}},error:function(){alert("No skin-"+e+" found")}})},select_skin:function(e){var a={action:"tcard_select_skin",security:tcard.select_skin,group_id:tcard.group_id,group_name:t(".tcard-group-title").val(),skin_type:e};t.ajax({url:ajaxurl,type:"POST",data:a,success:function(){window.onbeforeunload=null,location.reload()},error:function(){alert("File missing!")}})}}})}(jQuery);